%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This paper is far from complete and the coding style is inexistent.
% I hope it would help to clarify some details, I will complete it 
% later.
%
% Reviews, corrections and remarks are welcomed 
% and to be sent to l.brieulle(at)gmail(dot)com
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper]{article} % papier A4
\usepackage[utf8]{inputenc}      % accents dans le source
\usepackage[T1]{fontenc}         % accents dans le pdf
\usepackage{textcomp}            % symboles complémentaires (euro)
\usepackage[frenchb]{babel}      % titres en français
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage[colorlinks=false]{hyperref}
\hypersetup{
    colorlinks=false,
}
\usepackage{enumerate}
\usepackage{pgf}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{tikz}
\usepackage{tikz-cd}
\usetikzlibrary{matrix,arrows,decorations.pathmorphing}
\numberwithin{equation}{section}
\newcommand\nroot[1]{\textit{#1}\up{\textit{ième}}}
\newcommand\zmodn[1]{\mathbb{Z}/#1\mathbb{Z}}
\newcommand\GF[1]{\mathbb{F}_{#1}}
\newcommand\Irr[2]{\textup{Irr}_{#1}(#2)}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Ouput:}}
\newcommand\Tr[1]{\textup{Tr}\left(#1\right)}
\begin{document}
\newtheorem{thm}{Thèorème}
\newtheorem{lem}[thm]{Lemme}
\newtheorem{cor}{Corollaire}
\newtheorem{prop}[thm]{Proposition}
\theoremstyle{definition}
\newtheorem*{defn}{Définition}
\newtheorem*{ex}{Exemple}
\theoremstyle{remark}
\newtheorem*{rem}{Remarque}
Ci-dessous se trouve une version de l'algorithme \textit{convert}, implémenté en \bsc{sage} ici : \url{https://github.com/brieulle/Rains-pinch/blob/master/Rains\_isom\_normal.sage}.\\\par
On considère $\GF{q^n}$ et on se donne un élément $z\in\GF{q^n}$ quelconque et un élément normal $v\in\GF{q^n}$. Le but va être de trouver les coefficients $c_i$ de $z$ dans la base normale $v^{q^i}$, \textit{i.e.} tels que :
\[z = \sum_{i=0}^{n-1}{c_i.v^{q^i}}\]
Pour cela nous aurons besoin de passer par l'anneau quotient $\mathbb{F}_p[\omega]/(\omega^n - 1)$.\\\par
L'algorithme se place dans le cadre du calcul de l'isomorphisme entre deux corps finis de même cardinal. Après avoir trouvé deux éléments normaux $v$ et $w$ qui coïncident \textit{via} un isomorphisme $\phi$ (\textit{i.e.} tel que $f(\phi(v)) = 0$ et $\phi(v) = w$ pour $f$ le polynome minimal de $v$), on cherche à déterminer celui-ci en calculant son image en $x$ la classe de $X$.\par

Puisque $\phi(x^i) = \phi(x)^i$, pour déterminer l'image de la base polynomiale, on a besoin uniquement de l'image de $x$. Or, on a déjà à disposition un élément dont on connait l'image, alors si on exprime $x$ en fonction de cet élément, on pourra déterminer l'image de $x$ dans la base normale engendrée par $w$, il ne reste plus alors qu'à exprimer en fonction de la base $y^i$ :
\begin{align*}
\phi(x) &= \phi(\sum_{i\in I}{c_iv^{p^i}})= \sum_{i\in I}{c_i\phi(v^{p^i})}\\
&= \sum_{i\in I}{c_iw^{p^i}}\\
&= \sum_{i\in I}{b_iy^i}\\
\end{align*}
On peut aussi résumer la situation de la manière suivante :

\begin{center}
\begin{tikzpicture}
\matrix(m)[matrix of math nodes,
row sep=3em, column sep=3em,
text height=2ex, text depth=0ex]
{\bigoplus\limits_{i\in I}{x^i\cdot\GF{q}} & \bigoplus\limits_{i\in I}{y^i\cdot\GF{q}}\\
\bigoplus\limits_{i\in I}{v^{p^i}\cdot\GF{q}} & \bigoplus\limits_{i\in I}{w^{p^i}\cdot\GF{q}}\\};
\path[->,font=\scriptsize,>=angle 90]
(m-1-1) edge node[auto] {$\phi$} (m-1-2)
(m-2-1) edge node[auto] {$\phi$} (m-2-2)
(m-1-1) edge node[auto] {$\pi$} (m-2-1)
(m-2-2) edge node[auto] {$\pi^{\prime}$} (m-1-2);
\end{tikzpicture}
\end{center}
La fonction $\pi^{\prime}$ est plus ou moins gratuite, il suffit d'exprimer $w$ en fonction des $y^i$ mais en général les éléments sont déjà exprimés en fonction de la base polynomiale. La seule fonction qui pose un problème est la fonction $\pi$ qui permet d'exprimer $x$ en fonction des $v^{p^i}$. C'est elle que l'algorithme va calculer; ou plus exactement, l'algorithme va déterminer directement les coefficients $c_i$. Le morphisme $\phi$ se détermine alors simplement en calculant l'image de $x$.
\begin{defn}
Pour l'algorithme \ref{alg1}, l'opération $\cdot$ représentera la multiplication par un scalaire de $\GF{q}$; l'opération $\times$ représente un produit entre deux vecteurs de $\GF{q^n}$; si on ne met rien, il s'agit de la multiplication dans $\GF{q}$.
\end{defn}

\begin{algorithm}
\caption{Conversion de la base polynomiale vers la base normale}
\label{alg1}
\begin{algorithmic}[1]
\REQUIRE $z$, $v$, $n$, $p$, $\omega$ \COMMENT{$z\in\GF{q^n}$, $v$ élément normal, $n$ degré de l'extension, $p$ caractéristique, $\omega$ défini ci-dessus}
\ENSURE $c$ \COMMENT{Tuple contenant les coefficients de $z$ dans la base normale engendrée par $v$}
\bigskip
\FOR{$i = 0$ \TO $n-1$}
    \STATE $B_i = \Tr{v\times v^{q^{n-(i+1)}}}$
\ENDFOR
\medskip
\STATE $I = (\sum_{i = 0}^{n-1}{B_i\cdot \omega^i})^{-1}$
\medskip
\FOR{$i = 0$ \TO $n-1$}
    \STATE $T_i = \Tr{v\times z^{q^{n-i}}}$
\ENDFOR
\medskip
\FOR{$i = 0$ \TO $n-1$}
    \STATE $c_i = \sum_{j=0}^{n-1}{I_{(j-i)\bmod n}T_j}$
\ENDFOR
\RETURN $c$

\end{algorithmic}
\end{algorithm}


\subsubsection*{Esquisse de calcul de complexité pour l'algorithme 1}
De la ligne 1 à 3, il s'agit de mettre à un puissance $q$ plusieurs polynômes, de les multiplier par un autre polynôme et enfin de calculer la trace de chacun de ces produits; on effectue alors $n$ fois cette opération, d'où un $O(nM(n)\textup{log}\,q) + O(nM(n)) + n\textup{T}(n) = O(nM(n)\textup{log}\,q) + O(nM(n))$, où $\textup{T}(n)$ est la complexité du calcul de la trace d'un élément de $\GF{q^n}$ et $\textup{T}(n) = O(M(n))$.\par
Pour la ligne 4, il s'agit dans un premier temps de la muliplication par un scalaire d'éléments de $\mathbb{F}_p[\omega]/(\omega^n - 1)$ puis de $n$ sommes de polynômes. Ensuite, on inverse le polynôme et on prend la trace de l'élément qu'il représente; ce qui nous donne $O(n) + O(M(n).\textup{log }n)$.\par 
De la ligne 5 à 7, il s'agit de la même complexité de la ligne 1 à 3, d'où encore une complexité de $O(nM(n)\textup{log}\,q) + O(nM(n))$.\par
La ligne 8 à 10, il s'agit de $n$ sommes de $n$ multiplications dans le corps de base $\GF{q}$; \textit{i.e.} un grand $O(n)$.\par
Au final, la complexité de l'algorithme serait égal à:
 \[2O(nM(n)) + 2O(nM(n)\textup{log }q) +  O(M(n)\textup{log }n) + 2n\textup{T}(n) + O(n)\] 
ou de manière plus simple, elle est en $O(nM(n)\textup{log}\,q)$ qui domine le reste.

\begin{prop}
Soit $z$ un élément quelconque de $\GF{p^n}$ et $v$ un élément normal de $\GF{p^n}$, avec $p$ premier. Alors l'algorithme \ref{alg1} renvoie les coefficients de $z$ dans la base normale engendrée par $v$.
\end{prop}
\begin{proof}
On a par définition :
\[z = \sum_{0 \leq i < n}{c_iv^{p^i}}\]
avec les $c_i\in\GF{p}$. En utilisant le Frobenius, on obtient pour $0\leq j < n$ :
\[z^{p^{n-j}} = \sum_{0\leq i < n}{c_iv^{p^{i+n-j}}}\]
On va alors appliquer une certaine forme linéaire $\lambda$ (il s'agira de la trace) :
\[\lambda\left(z^{p^{n-j}}\right) = \sum_{0\leq i < n}{c_i\lambda\left(v^{p^{i+n-j}}\right)}\]\par
Soit maintenant la matrice $B$ définie par :
\[b_{ij} = \lambda\left(v^{p^{i+n-j}}\right)\]
Si la matrice est inversible alors on a terminé, puisque si on note $d_{ij}$ les coefficients de $B^{-1}$, on a bien :
\[c_i = \sum_{0\leq j < n}{d_{ij}\lambda\left(z^{p^{n-j}}\right)}\]
pour $0\leq i < n$. Reste à savoir si la matrice $B$ sera effectivement inversible.\par
Pour commencer, on peut rappeler un résultat classique d'algèbre linéaire qui énonce que toute forme linéaire peut s'exprimer sous la forme :
\[x \mapsto \Tr{\alpha x}\]
pour un certain $\alpha\in\GF{p}$. On peut donc écrire les coefficients de $B$ sous la forme suivante :
\[b_{ij} = \Tr{\alpha v^{p^{i+n-j}}} = \Tr{\alpha^{p^j}v^{p^i}}\]
On va voir que dans notre cas, il nous suffira de choisir $\alpha = v$.

\begin{lem}%[Rains \cite{Rai}]
Soit $\alpha,\beta\in\GF{p^n}$ et la matrice $A$ défini par les coefficients $a_{ij} = \Tr{\alpha^{p^i}\beta^{p^j}}$, $A$ est inversible si et seulement si $\alpha$ et $\beta$ sont des éléments normaux.
\end{lem}
\begin{proof}
Supposons que $\alpha$ ne soit pas un élément normal. Dans ce cas, il existe une relation de dépendance linéaire entre les conjugués de $\alpha$, alors la combinaison linéaires des lignes de $A$ correspondant à cette dépendance est $0$ puisque la trace est linéaire; $A$ ne peut donc pas être inversible.\par
Inversement, supposons que $A$ ne soit pas inversible. Il existe alors une combinaison linéaire de ses lignes qui vaut $0$. Ou encore, il existe une combinaison linéaire $\alpha^{\prime}$ des conjugués $\alpha$ telle que $\Tr{\alpha^{\prime}\beta^{p^j}} = 0$ pour tout $j$ entre $0$ et $n-1$; \textit{i.e.} telle que :
\[\Tr{\alpha^{\prime}\beta + \alpha^{\prime}\beta^p + \dots + \alpha^{\prime}\beta^{p^{n-1}}}\]
Or la trace est surjective, donc si $\beta$ est normal cela implique que $\alpha^{\prime} = 0$ mais alors $\alpha$ n'est pas un élément normal; ce qui démontre le lemme.\\
\end{proof}
Reste maintenant à expliquer d'où vient l'anneau $\mathbb{F}_p[\omega]/(\omega^n - 1)$. Il se trouve que la matrice $B$ a une propriété particulière, elle est ce qu'on appelle une matrice circulante, \textit{i.e.} pour obtenir la ligne suivante, il suffit de décaler tous les éléments vers la droite en faisant passer le dernier coefficient en première position. Ou plus formellement, si :
\[i_1 - j_1 \equiv i_2 - j_2 \bmod n\]
alors on a 
\[b_{i_1j_1} = b_{i_2j_2}\]
et inversement. Donc, si on considère :
\[b_{i+1j+1} = \lambda\left(v^{p^{(i+1) + n - (j+1)}}\right) = \lambda\left(v^{p^{i+n-j}}\right)\]
on a bien que $b_{ij} = b_{i+1j+1}$ avec $(i+1) - (j+1) \equiv i - j \bmod n$ comme annoncé plus haut. Or, il se trouve que les matrices circulantes de $M_n(\GF{p})$ forment un anneau qui est isomorphe à l'anneau $\mathbb{F}_p[\omega]/(\omega^n - 1)$ \textit{via} l'isomorphisme suivant :
\begin{equation*}
\label{isomconvert}
\psi : B \longmapsto \sum_{0\leq j < n}{b_{0j}\omega^j}
\end{equation*}\par
La matrice identité étant contenue dans l'ensemble des matrices circulantes, montrons alors qu'il s'agit d'un sous-anneau. On voit facilement que la sommes de deux matrices circulantes est tourjous circulante. Pour le produit, prenons $A$ et $B$ deux matrices circulantes de tailles $n$, on notera $C := AB$. On a :
\[c_{ij} = \sum_{k=0}^{n-1}{a_{ik}b_{kj}}\]
Donc si on défini, en tenant compte de la structure des matrices circulantes, $a_{i\,-1} := a_{in-1}$ et $b_{-1j} := b_{n-1j}$, on arrive à :
\begin{align*}
c_{i+1j+1} &= \sum_{k=0}^{n-1}{a_{i+1k}b_{kj+1}}\\
&= \sum_{k=1}^{n-1}{a_{ik-1}b_{k-1j}} + a_{in-1}b_{n-1j}\\
&= \sum_{k^{\prime}=0}^{n-1}{a_{ik^{\prime}}b_{k^{\prime}j}}\\
&= c_{ij}
\end{align*}
ce qui montre que le produit est encore une matrice circulante. Il s'agit donc bien d'un sous-anneau.\par
Montrons d'abord que l'application $\psi$ est un morphisme d'anneau. On a bien évidemment $\psi(I_n) = 1$ et de manière relativement immédiate :
\begin{align*}
\psi(A + B) &= \sum_{0\leq j < n}{(a_{0j} + b_{0j})\omega^j}\\
&= \sum_{0\leq j < n}{a_{0j}\omega^j} + \sum_{0\leq j < n}{b_{0j}\omega^j}\\
&= \psi(A) + \psi(B)\\
\end{align*}
Maintenant, d'après la formule du produit de deux polynômes, on a :
\begin{align*}
\psi(A)\psi(B) &= \sum_{0\leq k < n}{\bigg(\sum_{i+j=k}{a_{0i}b_{0j}}\bigg)\omega^k}\\
&= \sum_{0\leq k < n}{\bigg(\sum_{i\equiv k-j \bmod n}{a_{0i}b_{0(k-i \bmod n)}}\bigg)\omega^k}\\
\end{align*}
Mais $b_{0k-i} = b_{ik}$ puisque $0 -(k-i) \equiv i-k \bmod n$; en tenant compte du fait que $i$ parcourt tout $\zmodn{n}$, on arrive finalement à :
\[\sum_{0\leq k < n}{\bigg(\sum_{0\leq i < n}{a_{0i}b_{ik}}\bigg)\omega^k} = \psi(AB)\]\par
Comme les $\omega^k$ sont linéairement indépendants par définition, pour que l'image d'une matrice circulante soit égale à $0$, il faut que sa première ligne, et donc toutes les autres, soit nulle; d'où $\textup{Ker}\,\psi = \{0_n\}$. La surjectivité est immédiate, il suffit de prendre les coefficients d'un élément quelconque $u$ de $\GF{p}[\omega]/(\omega^n - 1)$ et de définir la matrice $A$ de coefficients $a_{ij} = u_{(i-j \bmod n)}$ pour $i,j\in\zmodn{n}$, où les $u_i$ sont les coefficients $u$; on aura alors $\psi(A) = u$.\\\par
Ainsi, comme $\psi$ est un isomorphisme, on a bien :
\[\psi(B^{-1}) = \psi(B)^{-1} = \sum_{0\leq k < n}{d_{0k}\omega^k}\]
ce qui achève la démonstration.\\
\end{proof}
\begin{rem}
Les résultats sont encore valables en remplaçant $p$ par $q$.
\end{rem}

\end{document}







